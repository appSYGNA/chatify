<!DOCTYPE html>
<html lang="en">
<head>
<title>Chatify!</title>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
<script src="/nowjs/now.js"></script>

<script>
$(document).ready(function(){

  now.receiveMessage = function(name, date, message){
    $("#messages").append("<br>" + date + " " + name + ": " + message);
  }
  
  now.receiveHistory = function(history){
  	$.each(history, function(key,value){
		$("#messages").append("<br>" + value["date"] + " " + value["name"] + ": " + value["message"]);
  	});
  }
  
  now.updateUserList = function(name) {
	 // $.each(names, function(key, value) { 
		  $("#users").append("<span id='"+name+"'><br>" + name + "</span>");
	//	});
  }
  
  now.removeUser = function(name){
	  $("#"+name).remove();
  }

  $("#send-button").click(function(){
    sendMessage();
  });
  
	$('#text-input').bind('keypress', function(e) {
		if(e.keyCode==13){
			sendMessage();
				// Enter pressed... do anything here...
		}
	});

  now.name = prompt("What's your name?", "");

	sendMessage = function(){
		now.distributeMessage($("#text-input").val());
		$("#text-input").val("");
	}
});
</script>
</head>

<body>
  <div id="messages"></div>
  <input type="text" id="text-input">
  <input type="button" value="Send" id="send-button">
  
  <div id="users"></div>
</body>
</html>
